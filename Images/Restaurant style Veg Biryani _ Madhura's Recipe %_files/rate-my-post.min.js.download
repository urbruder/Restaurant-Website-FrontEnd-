var rate_my_post=function(exports,t){"use strict";class e{constructor(e,i){this.widgetContainer=e,this.socialEnabled=t.social,this.ratingRequired=t.positiveThreshold,this.rating=i,this.ratingWidget=document.querySelector(this.widgetContainer+".js-rmp-rating-widget"),this.socialWidget=document.querySelector(this.widgetContainer+".js-rmp-social-widget"),this.events()}events(){var t,e;2!=this.socialEnabled||this.rating<=this.ratingRequired||(null===(t=this.socialWidget)||void 0===t||null===(t=t.classList)||void 0===t||t.add("rmp-social-widget--visible"),null===(e=this.ratingWidget)||void 0===e||null===(e=e.classList)||void 0===e||e.add("rmp-rating-widget--hidden"))}}class i{constructor(t,e){this.widgetContainer=t,this.successMsg=e.successMsg,this.errorMsg=e.errorMsg,this.msgContainer=document.querySelector(this.widgetContainer+".js-rmp-feedback-msg"),this.input=document.querySelector(this.widgetContainer+".js-rmp-feedback-input"),this.button=document.querySelector(this.widgetContainer+".js-rmp-feedback-button"),this.loader=document.querySelector(this.widgetContainer+".js-rmp-feedback-loader"),this.events()}events(){if(this.loader.classList.remove("rmp-feedback-widget__loader--visible"),this.errorMsg.length)return this.msgContainer.classList.add("rmp-feedback-widget__msg--alert"),void(this.msgContainer.innerHTML=this.errorMsg.join("<br />"));this.msgContainer.classList.remove("rmp-feedback-widget__msg--alert"),this.msgContainer.textContent=this.successMsg,this.input.remove(),this.button.remove()}}class s{constructor(e,i,s,n,r){this.widgetContainer=e,this.postID=i,this.feedback=s,this.settings=t,this.duration=!1,this.ratingID=r,this.token=n,this.recaptcha=t.grecaptcha,this.recaptchaKey=t.siteKey,this.data={action:"process_feedback",feedback:this.feedback,postID:this.postID,duration:this.duration,rating_id:this.ratingID,rating_token:this.token,nonce:this.settings.nonce},this.events()}events(){2==this.recaptcha?grecaptcha.ready((()=>{grecaptcha.execute(this.recaptchaKey,{action:"RMPfeedback"}).then((t=>{this.data.token=t,this.saveFeedback()}))})):this.saveFeedback()}async saveFeedback(){const t=new FormData;Object.keys(this.data).forEach((e=>t.append(e,this.data[e])));const e=await fetch(this.settings.admin_ajax,{method:"POST",body:t});if(!e.ok)return;const s=await e.json();new i(this.widgetContainer,s)}}class n{constructor(e,i,s,n,r){this.widgetContainer=e,this.postID=i,this.feedbackEnabled=t.feedback,this.maxRating=t.positiveThreshold,this.emptyFeedbackMsg=t.emptyFeedback,this.msgContainer=document.querySelector(this.widgetContainer+".js-rmp-feedback-msg"),this.rating=s,this.ratingWidget=document.querySelector(this.widgetContainer+".js-rmp-rating-widget"),this.feedbackWidget=document.querySelector(this.widgetContainer+".js-rmp-feedback-widget"),this.inputContainer=document.querySelector(this.widgetContainer+".js-rmp-feedback-input"),this.submitButton=document.querySelector(this.widgetContainer+".js-rmp-feedback-button"),this.loader=document.querySelector(this.widgetContainer+".js-rmp-feedback-loader"),this.input=!1,this.token=n,this.ratingID=r,this.events()}events(){2!=this.feedbackEnabled||this.rating>this.maxRating||(this.feedbackWidget.classList.add("rmp-feedback-widget--visible"),this.ratingWidget.classList.add("rmp-rating-widget--hidden"),this.submitButton.addEventListener("click",(t=>this.submitButtonClicked())))}submitButtonClicked(){if(this.input=this.inputContainer.value,this.input.trim().length<1)return this.msgContainer.classList.add("rmp-feedback-widget__msg--alert"),void(this.msgContainer.textContent=this.emptyFeedbackMsg);this.submitButton.replaceWith(this.submitButton.cloneNode(!0)),this.submitButton=document.querySelector(this.widgetContainer+".js-rmp-feedback-button"),this.loader.classList.add("rmp-feedback-widget__loader--visible"),new s(this.widgetContainer,this.postID,this.input,this.token,this.ratingID)}}class r{constructor(){this.starsToBeReplaced=document.querySelectorAll(".js-rmp-replace-half-star"),this.starsToBeRemoved=document.querySelectorAll(".js-rmp-remove-half-star"),this.testElement=document.createElement("x-test"),this.supportTest=typeof this.testElement.style.webkitBackgroundClip,this.events()}events(){let t=!0;"undefined"===this.supportTest&&(t=!1),t||(this.starsToBeReplaced.forEach((t=>{t.classList.remove("rmp-icon--half-highlight"),t.classList.add("rmp-icon--full-highlight")})),this.starsToBeRemoved.forEach((t=>{t.classList.remove("rmp-icon--half-highlight")})))}}class o{constructor(e,i,s){this.postID=i,this.widgetContainer=e,this.avgRating=s,this.resultIcons=document.querySelectorAll(".js-rmp-results-widget--"+i+" .js-rmp-results-icon"),this.ratingIcons=document.querySelectorAll(this.widgetContainer+".js-rmp-rating-icon"),this.hideRatings=t.notShowRating,this.events()}events(){let t=Math.floor(this.avgRating),e=!1,i=!1,s="",n=Math.round(this.avgRating%1*10);n>2&&n<8&&(e=!0),n>=8&&(i=!0),n>2&&n<5&&(s="js-rmp-remove-half-star"),n>=5&&n<8&&(s="js-rmp-replace-half-star"),this.resultIcons.forEach(((n,r)=>{r+1<=t&&n.classList.add("rmp-icon--full-highlight"),e&&r+1==t+1&&(n.classList.add("rmp-icon--half-highlight"),n.classList.add(s)),i&&r+1==t+1&&n.classList.add("rmp-icon--full-highlight")})),2!=this.hideRatings&&(this.ratingIcons.forEach(((n,r)=>{r+1<=t&&n.classList.add("rmp-icon--full-highlight"),e&&r+1==t+1&&(n.classList.add("rmp-icon--half-highlight"),n.classList.add(s)),i&&r+1==t+1&&n.classList.add("rmp-icon--full-highlight")})),new r)}}function a(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var h,c={exports:{}};
/*!
   * JavaScript Cookie v2.2.1
   * https://github.com/js-cookie/js-cookie
   *
   * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
   * Released under the MIT license
   */h=function(){function t(){for(var t=0,e={};t<arguments.length;t++){var i=arguments[t];for(var s in i)e[s]=i[s]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function i(s){function n(){}function r(e,i,r){if("undefined"!=typeof document){"number"==typeof(r=t({path:"/"},n.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var o=JSON.stringify(i);/^[\{\[]/.test(o)&&(i=o)}catch(t){}i=s.write?s.write(i,e):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var h in r)r[h]&&(a+="; "+h,!0!==r[h]&&(a+="="+r[h].split(";")[0]));return document.cookie=e+"="+i+a}}function o(t,i){if("undefined"!=typeof document){for(var n={},r=document.cookie?document.cookie.split("; "):[],o=0;o<r.length;o++){var a=r[o].split("="),h=a.slice(1).join("=");i||'"'!==h.charAt(0)||(h=h.slice(1,-1));try{var c=e(a[0]);if(h=(s.read||s)(h,c)||e(h),i)try{h=JSON.parse(h)}catch(t){}if(n[c]=h,t===c)break}catch(t){}}return t?n[t]:n}}return n.set=r,n.get=function(t){return o(t,!1)},n.getJSON=function(t){return o(t,!0)},n.remove=function(e,i){r(e,"",t(i,{expires:-1}))},n.defaults={},n.withConverter=i,n}((function(){}))},c.exports=h();var d=a(c.exports);class g{constructor(t){this.postID=t,this.existingCookie=d.get("rmp-rate"),this.events()}events(){if(void 0===this.existingCookie)return void d.set("rmp-rate",this.postID,{expires:20});d.remove("rmp-rate");let t=this.existingCookie.split(",");t.length>=20&&t.shift(),t.push(this.postID);let e=t.toString();d.set("rmp-rate",e,{expires:20})}}class l{constructor(t){this.commonAnalyticsTracker=typeof window.ga,this.MiAnalyticsTracker=typeof window.__gaTracker,this.rating=t,this.events()}events(){return"undefined"!==this.commonAnalyticsTracker?(ga("send","event","Rate my Post","Post Rated "+this.rating+"/5"),void console.log("ga analytics tracker")):"undefined"!==this.MiAnalyticsTracker?(__gaTracker("send","event","Rate my Post","Post Rated "+this.rating+"/5"),void console.log("__gaTracker analytics tracker")):void console.log("Analytics tracker not found")}}class u{constructor(e,i,s,n){this.postID=e,this.widgetContainer=i,this.voteCount=s.voteCount,this.avgRating=s.avgRating,this.errorMsg=s.errorMsg,this.token=s.token,this.id=s.id,this.avgRatingContainer=document.querySelectorAll(this.widgetContainer+".js-rmp-avg-rating, .js-rmp-results-widget--"+e+" .js-rmp-avg-rating"),this.voteCountContainer=document.querySelectorAll(this.widgetContainer+".js-rmp-vote-count, .js-rmp-results-widget--"+e+" .js-rmp-vote-count"),this.noVotesContainer=document.querySelector(this.widgetContainer+".js-rmp-not-rated"),this.resultsTextContainer=document.querySelector(this.widgetContainer+".js-rmp-results"),this.ratingIcons=document.querySelectorAll(this.widgetContainer+".js-rmp-rating-icon"),this.resultIcons=document.querySelectorAll(".js-rmp-results-widget--"+e+" .js-rmp-results-icon"),this.msgContainer=document.querySelector(this.widgetContainer+".js-rmp-msg"),this.tnxMsg=t.afterVote,this.rating=n,this.hideRatings=t.notShowRating,this.events()}events(){var t,i;if(this.errorMsg.length)return this.msgContainer.innerHTML=this.errorMsg.join("<br />"),this.msgContainer.classList.add("rmp-rating-widget__msg--alert"),void this.ratingIcons.forEach((t=>{t.classList.remove("rmp-icon--processing-rating","rmp-icon--hovered")}));this.avgRatingContainer&&this.avgRatingContainer.forEach((t=>{t.textContent=this.avgRating})),this.voteCountContainer&&this.voteCountContainer.forEach((t=>{t.textContent=this.voteCount})),this.toneDownIcons(),this.highlightIcons(),null===(t=this.noVotesContainer)||void 0===t||null===(t=t.classList)||void 0===t||t.add("rmp-rating-widget__not-rated--hidden"),null===(i=this.resultsTextContainer)||void 0===i||null===(i=i.classList)||void 0===i||i.remove("rmp-rating-widget__results--hidden"),this.msgContainer.textContent=this.tnxMsg,new e(this.widgetContainer,this.rating),new n(this.widgetContainer,this.postID,this.rating,this.token,this.id),new g(this.postID),new l(this.rating)}toneDownIcons(){this.ratingIcons.forEach((t=>{t.classList.remove("rmp-icon--full-highlight","rmp-icon--half-highlight","rmp-icon--processing-rating","rmp-icon--hovered","js-rmp-remove-half-star","js-rmp-replace-half-star")})),this.resultIcons.forEach((t=>{t.classList.remove("rmp-icon--full-highlight","rmp-icon--half-highlight","rmp-icon--processing-rating","js-rmp-remove-half-star","js-rmp-replace-half-star")}))}highlightIcons(){new o(this.widgetContainer,this.postID,this.avgRating)}}class m{constructor(e,i,s,n){this.postID=e,this.widgetContainer=i,this.rating=s,this.duration=Math.floor(Date.now()/1e3)-n,this.settings=t,this.recaptcha=t.grecaptcha,this.recaptchaKey=t.siteKey,this.data={action:"process_rating",star_rating:this.rating,postID:this.postID,duration:this.duration,nonce:this.settings.nonce},this.events()}events(){2==this.recaptcha?grecaptcha.ready((()=>{grecaptcha.execute(this.recaptchaKey,{action:"RMPrating"}).then((t=>{this.data.token=t,this.saveRating()}))})):this.saveRating()}async saveRating(){const t=new FormData;Object.keys(this.data).forEach((e=>t.append(e,this.data[e])));const e=await fetch(this.settings.admin_ajax,{method:"POST",body:t});if(!e.ok)return;const i=await e.json();new u(this.postID,this.widgetContainer,i,this.rating)}}class p{constructor(t){this.widgetContainer=t,this.ratingItems=document.querySelectorAll(this.widgetContainer+".js-rmp-rating-item"),this.ratingTextContainer=document.querySelector(this.widgetContainer+".js-rmp-hover-text"),this.submitBtn=document.querySelector(this.widgetContainer+".js-submit-rating-btn"),this.events()}events(){this.ratingItems.forEach((t=>{t.replaceWith(t.cloneNode(!0))})),this.ratingItems=document.querySelectorAll(this.widgetContainer+".js-rmp-rating-item"),this.submitBtn.replaceWith(this.submitBtn.cloneNode(!0)),this.submitBtn=document.querySelector(this.widgetContainer+".js-submit-rating-btn"),this.ratingItems.forEach((t=>{t.style.cursor="default"})),this.submitBtn.classList.remove("rmp-rating-widget__submit-btn--visible"),this.ratingTextContainer&&(this.ratingTextContainer.textContent="")}}class v{constructor(e,i){this.postID=i,this.widgetContainer=e,this.existingCookie=d.get("rmp-rate"),this.cookiesDisabled=t.cookieDisable,this.tnxMsg=t.afterVote,this.msgContainer=document.querySelector(this.widgetContainer+".js-rmp-msg"),this.ratingWidget=document.querySelector(this.widgetContainer+".js-rmp-rating-widget"),this.events()}events(){var t;if(2==this.cookiesDisabled)return;if(void 0===this.existingCookie)return;this.existingCookie.split(",").includes(this.postID)&&(new p(this.widgetContainer),this.msgContainer&&(this.msgContainer.textContent=this.tnxMsg),null===(t=this.ratingWidget)||void 0===t||null===(t=t.classList)||void 0===t||t.add("rmp-rating-widget--has-rated"))}}class C{constructor(){this.requiresLogin=t.votingPriv,this.isLoggedIn=t.loggedIn,this.ratingWidget=document.querySelectorAll(".js-rmp-rating-widget"),this.events()}events(){2!=this.requiresLogin||this.isLoggedIn||(new p(""),this.ratingWidget.forEach((t=>{t.classList.add("rmp-rating-widget--no-privilege")})))}}class w{constructor(e){this.postID=e,this.widgetContainer=".js-rmp-widgets-container--"+e+" ",this.resultsWidget=".js-rmp-results-widget--"+e,this.ratingItems=document.querySelectorAll(this.widgetContainer+".js-rmp-rating-item"),this.ratingItemsList=document.querySelector(this.widgetContainer+".js-rmp-rating-icons-list"),this.ratingIcons=document.querySelectorAll(this.widgetContainer+".js-rmp-rating-icon"),this.ratingTextContainer=document.querySelector(this.widgetContainer+".js-rmp-hover-text"),this.ratingText=!1,this.hoveredItemOrder=0,this.rating=0,this.supportsHover=window.matchMedia("(hover: hover)"),this.startTime=Math.floor(Date.now()/1e3),this.preventAccidental=t.preventAccidental,this.hoverTexts=t.hoverTexts,this.submitBtn=document.querySelector(this.widgetContainer+".js-submit-rating-btn"),this.saveRating=!1,this.events()}events(){this.doubleWidgetCheck(),this.ratingItems.forEach((t=>{t.style.cursor="pointer",t.addEventListener("mouseover",(t=>this.hoverIcons(t))),t.addEventListener("mouseout",(t=>this.stopHoverIcons())),t.addEventListener("click",(t=>this.ratingIconClicked(t)))})),this.ratingItemsList.addEventListener("mouseleave",(t=>this.removeHoverTexts())),new v(this.widgetContainer,this.postID),new C}doubleWidgetCheck(){let t=document.querySelectorAll(this.widgetContainer),e=document.querySelectorAll(this.resultsWidget);(t.length>1||e.length>1)&&(t.forEach(((t,e)=>{e>0&&t.remove()})),e.forEach(((t,e)=>{e>0&&t.remove()})))}hoverIcons(t){this.hoveredItemOrder=parseInt(t.currentTarget.dataset.value,10),this.ratingText=t.currentTarget.dataset.descriptiveRating,this.ratingIcons.forEach(((t,e)=>{e<this.hoveredItemOrder?t.classList.add("rmp-icon--hovered"):t.classList.remove("rmp-icon--hovered"),this.supportsHover&&2==this.hoverTexts&&this.ratingTextContainer&&(this.ratingTextContainer.textContent=this.ratingText)}))}stopHoverIcons(){this.ratingIcons.forEach((t=>{t.classList.remove("rmp-icon--hovered")}))}removeHoverTexts(){this.ratingTextContainer&&(this.ratingTextContainer.textContent="")}ratingIconClicked(t){this.rating=parseInt(t.currentTarget.dataset.value,10),this.ratingIcons.forEach(((t,e)=>{t.classList.remove("rmp-icon--processing-rating"),e<this.rating&&t.classList.add("rmp-icon--processing-rating")})),2!=this.preventAccidental?(new p(this.widgetContainer),this.saveRating=new m(this.postID,this.widgetContainer,this.rating,this.startTime)):this.submitButtonHandler()}submitButtonHandler(){this.submitBtn.classList.add("rmp-rating-widget__submit-btn--visible"),this.submitBtn.addEventListener("click",(t=>{this.saveRating||(this.saveRating=new m(this.postID,this.widgetContainer,this.rating,this.startTime)),new p(this.widgetContainer)}))}}class f{constructor(e){this.postID=e,this.widgetContainer=".js-rmp-widgets-container--"+e+" ",this.settings=t,this.avgRatingContainer=document.querySelectorAll(this.widgetContainer+".js-rmp-avg-rating, .js-rmp-results-widget--"+e+" .js-rmp-avg-rating"),this.voteCountContainer=document.querySelectorAll(this.widgetContainer+".js-rmp-vote-count, .js-rmp-results-widget--"+e+" .js-rmp-vote-count"),this.noVotesContainer=document.querySelector(this.widgetContainer+".js-rmp-not-rated"),this.resultsTextContainer=document.querySelector(this.widgetContainer+".js-rmp-results"),this.noVotesContainer=document.querySelector(this.widgetContainer+".js-rmp-not-rated"),this.resultsTextContainer=document.querySelector(this.widgetContainer+".js-rmp-results"),this.msgContainer=document.querySelector(this.widgetContainer+".js-rmp-msg"),this.data={action:"load_results",postID:this.postID,nonce:this.settings.nonce},this.events()}async events(){const t=new FormData;Object.keys(this.data).forEach((e=>t.append(e,this.data[e])));const e=await fetch(this.settings.admin_ajax,{method:"POST",body:t});if(!e.ok)return;const i=await e.json();let s=i.voteCount,n=i.avgRating,r=i.errorMsg;this.loadResults(s,n,r)}loadResults(t,e,i){if(i.length)this.msgContainer&&(this.msgContainer.textContent=i,this.msgContainer.classList.add("rmp-rating-widget__msg--alert"));else{var s,n,a,h;if(this.avgRatingContainer&&this.avgRatingContainer.forEach((t=>{t.textContent=e})),this.voteCountContainer&&this.voteCountContainer.forEach((e=>{e.textContent=t})),new o(this.widgetContainer,this.postID,e),0===e)null===(s=this.noVotesContainer)||void 0===s||null===(s=s.classList)||void 0===s||s.remove("rmp-rating-widget__not-rated--hidden"),null===(n=this.resultsTextContainer)||void 0===n||null===(n=n.classList)||void 0===n||n.add("rmp-rating-widget__results--hidden");else null===(a=this.noVotesContainer)||void 0===a||null===(a=a.classList)||void 0===a||a.add("rmp-rating-widget__not-rated--hidden"),null===(h=this.resultsTextContainer)||void 0===h||null===(h=h.classList)||void 0===h||h.remove("rmp-rating-widget__results--hidden");new r}}}class y{constructor(){this.ratingItems=document.querySelectorAll(".js-rmp-rating-item"),this.ratingItemsLists=document.querySelector(".js-rmp-rating-icons-list"),this.events()}events(){this.ratingItems.forEach((t=>{t.replaceWith(t.cloneNode(!0))})),this.ratingItems=document.querySelectorAll(".js-rmp-rating-item"),this.ratingItems.forEach((t=>{t.style.cursor="auto"})),this.ratingItemsLists.replaceWith(this.ratingItemsLists.cloneNode(!0)),this.ratingItemsLists=document.querySelector(".js-rmp-rating-icons-list")}}function b(){new r;let e=document.getElementsByClassName("js-rmp-rating-widget"),i=document.getElementsByClassName("js-rmp-results-widget"),s=document.getElementsByClassName("js-rmp-widgets-container");if(e.length<1&&i.length<1)return;let n=[];Array.from(s).forEach((t=>{let e=t.dataset.postId;n.push(e)}));let o=n.filter(((t,e)=>n.indexOf(t)===e));if(2==t.ajaxLoad)return new f(o[0]),void new w(o[0]);o.forEach((t=>{new w(t)}))}return"loading"!==document.readyState?b():document.addEventListener("DOMContentLoaded",b),exports.init_single_rate_my_post=function(t,e){e&&new f(t),new w(t)},exports.re_init=function(){console.log("re-init running"),new y,b()},exports}({},rmp_frontend);